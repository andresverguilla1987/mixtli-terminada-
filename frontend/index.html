<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mixtli ¬∑ TransferCloud</title>
  <link rel="icon" href="data:,">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .card { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.12); }
    .dashed { border: 2px dashed rgba(255,255,255,0.25); }
    .glass { backdrop-filter: blur(8px); }
    .hidden-input { display:none; }
    .progress { height: 8px; background: rgba(255,255,255,0.15); border-radius: 999px; overflow: hidden; }
    .progress > div { height: 100%; width: 0%; transition: width .2s ease; }
    pre.json { background: rgba(0,0,0,.35); padding: .75rem; border-radius: .75rem; overflow:auto }
    code { background: rgba(255,255,255,.08); padding: .15rem .35rem; border-radius: .375rem; }
  </style>
</head>
<body class="bg-slate-900 text-white min-h-screen">
  <div class="mx-auto max-w-5xl px-4 pt-8 pb-6">
    <div class="flex items-center justify-between gap-3">
      <h1 class="text-3xl font-bold">Mixtli <span class="opacity-70">TransferCloud</span> ‚ö°Ô∏è</h1>
      <div class="flex items-center gap-2 text-xs opacity-80">
        <span id="health-dot" class="inline-block w-2.5 h-2.5 rounded-full bg-gray-500"></span>
        <span id="health-label">sin probar</span>
        <button id="btn-settings" class="ml-3 px-2 py-1 rounded-lg bg-white/10 hover:bg-white/20">‚öôÔ∏è</button>
      </div>
    </div>

    <div class="mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3">
      <button id="tab-send" class="rounded-2xl px-4 py-3 font-semibold shadow border bg-blue-500 text-blue-950"> 
        <div class="text-sm">Modo Env√≠o</div><div class="text-xs opacity-80">(Links 7 d√≠as)</div>
      </button>
      <button id="tab-cloud" class="rounded-2xl px-4 py-3 font-semibold shadow border bg-emerald-500/20 border-emerald-400 hover:opacity-95">
        <div class="text-sm">Modo</div><div class="text-xs opacity-80">Nube</div>
      </button>
      <button id="btn-sub" class="rounded-2xl px-4 py-3 font-semibold shadow bg-purple-600 hover:opacity-95">
        <div class="text-sm">Suscripci√≥n</div><div class="text-xs opacity-80">$5/mes</div>
      </button>
      <button id="btn-buy" class="rounded-2xl px-4 py-3 font-semibold shadow bg-orange-600 hover:opacity-95">
        <div class="text-sm">Comprar</div><div class="text-xs opacity-80">GB ($1/GB)</div>
      </button>
    </div>

    <!-- SEND MODE -->
    <section id="pane-send" class="mt-6">
      <h2 class="text-2xl font-semibold flex items-center gap-3"><span>‚úâÔ∏è</span> Enviar por Link <span class="opacity-70 text-lg">(Expira en 7 d√≠as)</span></h2>
      <div id="dropzone" class="mt-4 dashed rounded-2xl px-6 py-16 flex flex-col items-center text-center transition-all">
        <div class="text-6xl">üìÅ</div>
        <p class="mt-4 text-lg opacity-90">Arrastra archivos aqu√≠ o haz clic para seleccionar.</p>
        <button id="btn-browse" class="mt-6 px-4 py-2 rounded-xl bg-blue-600 hover:bg-blue-500 shadow">Elegir archivos</button>
        <input id="file-input" type="file" multiple class="hidden-input" />
        <p class="mt-3 text-xs opacity-70">L√≠mite: <span id="limit"></span> por archivo</p>
      </div>

      <div id="queue" class="mt-6 space-y-3"></div>

      <div id="links" class="mt-8 hidden">
        <h3 class="text-lg font-semibold mb-3">Links recientes</h3>
        <div id="links-list" class="space-y-2"></div>
      </div>
    </section>

    <!-- CLOUD MODE -->
    <section id="pane-cloud" class="mt-6 hidden">
      <div class="flex items-end justify-between">
        <h2 class="text-2xl font-semibold flex items-center gap-3"><span>üìÅ</span> Tu Nube <span id="used" class="opacity-70 text-lg"></span></h2>
        <div class="flex gap-2">
          <button id="btn-upload-cloud" class="px-3 py-2 rounded-xl bg-emerald-600 hover:bg-emerald-500 shadow">Subir a Nube</button>
          <button id="btn-refresh" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20">Actualizar</button>
          <input id="file-input-cloud" type="file" multiple class="hidden-input" />
        </div>
      </div>

      <div id="cloud-status" class="mt-4 text-sm opacity-70 hidden"></div>
      <div id="cloud-grid" class="mt-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"></div>
      <div id="cloud-queue" class="mt-6 space-y-3"></div>
    </section>
  </div>

  <!-- Modal -->
  <div id="modal" class="fixed inset-0 bg-black/60 hidden items-center justify-center p-4">
    <div class="card glass max-w-2xl w-full rounded-2xl p-5">
      <div class="text-lg font-semibold" id="modal-title">Info</div>
      <div class="mt-2 text-sm opacity-90" id="modal-body"></div>
      <div id="cors-tools" class="mt-4 hidden">
        <div class="text-xs opacity-90 mb-2">Host del presigned URL: <code id="presign-host">‚Äî</code></div>
        <div class="flex flex-wrap gap-2 items-center">
          <button id="btn-test-cors" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20">Probar CORS de PUT (OPTIONS)</button>
          <button id="btn-copy-rule" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20">Copiar regla CORS para Cloudflare</button>
        </div>
        <pre id="diag" class="json mt-3 text-xs whitespace-pre-wrap hidden"></pre>
        <pre id="cors-json" class="json mt-3 text-xs whitespace-pre-wrap hidden"></pre>
      </div>
      <div class="mt-4 flex justify-end gap-2">
        <button id="modal-close" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings" class="fixed inset-0 bg-black/60 hidden items-center justify-center p-4">
    <div class="card glass max-w-lg w-full rounded-2xl p-5">
      <div class="text-lg font-semibold">‚öôÔ∏è Ajustes</div>
      <div class="mt-3 space-y-3">
        <label class="block text-sm">Backend URL (opcional)</label>
        <input id="inp-backend" class="w-full px-3 py-2 rounded-lg bg-white/10" placeholder="https://mixtli-terminada.onrender.com" />
        <label class="block text-sm">x-mixtli-token (opcional)</label>
        <input id="inp-token" class="w-full px-3 py-2 rounded-lg bg-white/10" placeholder="pega tu token si aplica" />
      </div>
      <div class="mt-4 flex justify-end gap-2">
        <button id="btn-save-settings" class="px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-500">Guardar</button>
        <button id="btn-close-settings" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20">Cerrar</button>
      </div>
    </div>
  </div>

  <footer class="py-8 text-center text-xs opacity-60">Mixtli ¬∑ Front v4_1 con diagn√≥stico CORS</footer>

  <script>window.APP_CONFIG = { MAX_BYTES: 2 * 1024 * 1024 * 1024 };</script>
  <script src="./app.js"></script>
</body>
</html>
